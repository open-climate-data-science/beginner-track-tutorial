---
title: "Beginner Tutorial"
author: "Livia Popa & Nick Gawron"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(tidyverse)
library(rnoaa)
library(lubridate)
# uploads library info
```
## Tutorial Learning Goals

We will be tackling these objectives:

- *Define* open data and reproducible science
- *Describe* how to navigate important aspects of the R/RStudio user-interface
- *Recall* how to extract public data from a web portal (Cardinal) and import it into a  data software (R/RStudio)
- *Demonstrate* understanding of dataset and statistical software through exploratory data analysis plots and numerical summaries

## Meet Mr. Wuf!

Mr. Wuf works for Mount Mitchell State Park in Burnsville, NC and was recently asked by his boss to write a report summarizing rainfall and temperature data for 2021. This report will be used to help optimize 2022 event planning (e.g., fall color viewing) for park visitors and maintenance scheduling for park staff. Mr. Wuf’s wife, Mrs. Wuf, recently told him about the State Climate Office of North Carolina’s new Cardinal and Station Scout data portals. He agrees with her that it would be a great opportunity to check out these new, free tools. After some preliminary sleuthing around Station Scout, he discovered there was a National Weather Service Cooperative Observer Program (COOP; https://www.weather.gov/rah/coop) station on park property (station # 315923). How did he miss this? Once he downloads these data from Cardinal, Mr. Wuf plans to put the skills he learned in an online R programming course to the test for this real-world, work-related project.

## Open Data Science

## What is Open Data and Reproducible Science?

Open data documents and shares research data openly for re-use.

Open data research aims to transform research by pushing change in the way that research is carried out and disseminated by digital tools. Open data should be:

- Publicly available: Open data is freely available on the internet.
- Reusable: Proper licensing is essential for research outputs so that users know any limitations on re-use
- Transparent: With appropriate metadata to explain how research output was produced and what it contains
- You can easily share what you did with your colleagues, collaborators, etc. and it’s easy to make changes and rerun analysis with different settings.


For more information go to this website: https://the-turing-way.netlify.app/reproducible-research/reproducible-research.html

## Importing Data From Cardinals

- Cardinal is a high-powered, user-oriented, one-stop-shop for North Carolina weather and climate data housed at the North Carolina State Climate Office. 
- Cardinal makes weather and climate data more accessible to users, with features and prompts that take the guesswork out of station and parameter identification and selection.

## Using data inspection functions

- `str` is a powerful function that allows you to determine what kind of variable we are working with 


### Data Types

- Date
- Str
- Char
- Double 
- Num

```{r}
library(readr)
cardinal <- read_csv("cardinal_data.csv")
#cardinal%>%filter(colnames(cardinal)!="MV")
```




```{r echo=F}
cardinal <- read_csv("cardinal_data.csv", 
     col_types = list(`Average Air Temperature (F)` = col_number(), 
         `Maximum Air Temperature (F)` = col_number(), 
         `Minimum Air Temperature (F)` = col_number(), 
         `Average Experimental Leaf Wetness (mV)` = col_number(), 
         `Total Precipitation (in)` = col_number(), 
         `Average Relative Humidity (%)` = col_number(), 
         `Average Soil Moisture (m3/m3)` = col_number(), 
         `Average Soil Temperature (F)` = col_number(), 
         `Average Solar Radiation (W/m2)` = col_number(), 
         `Average Station Pressure (mb)` = col_number()))

```

### Cleaning Data 


- usually a lot more messy 
- R can handle a lot of small details 


```{r}

# drop rows of missing values 
cardinal<-drop_na(cardinal)

#determine data types of all cols 
str(cardinal)

#create a date 
cardinal$Date<-as.Date(cardinal$Date, tryFormats= c("%m/%d/%y"))
view(cardinal)

#changes col names
colnames(cardinal)=c("date","AvgT","MaxT","MinT","AvgLw","Tprep","AvgHum","AvgSm","AvgSt","AvgSr","AvgStp")
```


## Making new Data

### When does it Rain ? 

```{r}
#me making new data

cardinal$IfRain<- (cardinal$Tprep>0)
cardinal$IfRain<-as.factor(as.integer(cardinal$IfRain))
cardinal

```



### Month Factor variable

- Factor variable is a category or bin we can place a value in. 

```{r}

# month variable 
cardinal$month<-month(cardinal$date)
cardinal$month<-as.factor(cardinal$month)

# str factor
str(cardinal)
```


###  Numerical Variable, Rain Difference

- Dollar sign + "Name of Variable"

```{r}
cardinal$TDiff <- cardinal$MaxT-cardinal$MinT
```



## Numerical Summaries


- Help us determine basic trends in data from printouts. 

- Summary gives as a 5 number summary of numeric variables

- Basic counts of factor variables

```{r}
summary(cardinal)
```

- Frequency Table to compare categorical / factor variables.

```{r}
# Frequency Table 
table(cardinal$month,cardinal$IfRain)
```





## Plotting Basic 


- Simple visual of frequency count

```{r}
# base plots in R, categorical variables
#does a count
plot(cardinal$IfRain,main ='Frequency Bar Plot of Rain Occurance',xlab="Occurence of Rain (0-No, 1- Yes)",ylab = "Number of Days")

```




- We will be using a package called `ggplot2`.

- Here is a good link: https://www.rstudio.com/resources/cheatsheets/

- Two basic functions: ggplot() & geom_plottype
  - Note we have not even had a title or label specs yet 

```{r}
# first ggplot figure

ggplot(cardinal,aes(x= date ,y= AvgLw))+ geom_point()
```



- Observe correlation and possible trend numerical variables

- Using cheatsheet, we can find a lot more plot types and options!

  - Note the use of `labs` statement


```{r}
ggplot(cardinal,aes(x=date,y=AvgT))+geom_line()+labs(title="Total Daily Rainfall by Date",y="Average Tempurature (F) ", x= "Date")
```

- options are very versatile inside a `+geom_statement()`

- We can use the cheatsheet to find out information about this 

- Note how we change atributes inside the `aes` statment

```{r}

ggplot(cardinal,aes(x=AvgT)) + geom_histogram(color="green",fill="orange")+labs(x="Average Temperature", y="Day",title ="Histogram of Average Temperature in Lake Wheeler")

# title and all labels included in one more statement 
```

- One popular option is to color-code based off of a categorial / factor variable 

- See the difference when we include `aes(col=month)`

- Below is a scatter plot

```{r}

# general plot
ggplot(cardinal,aes(x=AvgHum,y=AvgLw))+geom_point()

# coloring by month to observe trends
ggplot(cardinal,aes(x=AvgHum,y=AvgLw))+geom_point(aes(col=month))
```


- We can also use categorical variables on the x-axis

```{r}

# + geom_boxplot is a great tool to observe spreads

ggplot(cardinal,aes(x=month , y = TDiff))+geom_boxplot()
```


- Box-plots are cumbersome and not super helpful in visalization. 


### How could we make this boxplot better? 

- Note we are looking at average daily tempurature

```{r}

# + geom_boxplot is a great tool to observe spreads

ggplot(cardinal,aes(x=month , y = AvgT))+geom_boxplot()
```


### Fancy Plot Time


- Inspiration from ggridges documentation

- We want to stylize the boxplot from the above statement       

- We will be using a few libraries here: remeber to use `install.packages("library_name")` first before running the library statment. 

```{r}


library(viridis)     ## color palette
library(ggridges)    ## ridges
library(hrbrthemes)  ## plot theme
```

```{r}

ggplot(cardinal, aes(x = AvgT, y = month, fill = ..x..)) +
  
  geom_density_ridges_gradient(scale = 2, rel_min_height = 0.01, gradient_lwd = 1.) +
  
  scale_x_continuous(expand = c(0.01, 0)) +
  
  scale_y_discrete(expand = c(0.01, 0)) +
  
  scale_fill_viridis(name = "Temp. [ºF]", option = "C") +
  
  labs(title = 'Temperatures at  Lake Wheeler',
       subtitle = 'Mean temperatures (Fahrenheit) by month for 2020-2021\nData: ECONet Station', 
       x = "Mean Temperature") +
  
  theme_ridges(font_size = 13, grid = TRUE) + theme(axis.title.y = element_blank())


#


```

## After Completing This Tutorial You Can:

- *Define* open data and reproducible science
- *Describe* how to navigate important aspects of the R/RStudio user-interface
- *Recall* how to extract public data from a web portal (Cardinal) and import it into a  data software (R/RStudio)
- *Demonstrate* understanding of dataset and statistical software through exploratory data analysis plots and numerical summaries


